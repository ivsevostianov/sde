this is the old version of the code
