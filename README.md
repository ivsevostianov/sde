this is new version of the code
